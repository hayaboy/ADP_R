?c
vec <- c(166,168,170,172,174)
#Rì€ ì¸ë±ì‹±ì´ 1ë¶€í„° ì‹œìž‘í•¨
mean(vec)



?var()

var(vec)



vec2 <- c(60.0, 50.0 , 66.0 , 52.7 , 68.8 )


sd(vec2)


adv<-c(13,8,	10,	15,	12,	15,	14,	15,	17,	19,	20,	21,	22,	21,	25)
sales<-c(94,	70,	90,	100,	95,	100,	85,	95,	105,	105,	110,	105,	104,	105,	121)


cov(adv,sales)

cor(adv,sales)

install.packages("UsingR")

library(UsingR)

data(galton)

View(galton)

# structure
str(galton)


plot(galton$parent, galton$child)

time<-c(2,4,6,8)
score<-c(81,93,91,97)

plot(time,score)

cor(time,score)


í•œê¸€ê°€
?lm

#formula ì‹  ì¢…ì†ë³€ìˆ˜  ~ ë…ë¦½ë³€ìˆ˜ 

li_model1<-lm(score ~ time)


summary(li_model1)

#íšŒê·€ì‹
y=2.3*x+79

#ì˜ˆì¸¡

2.3*10+79
#10ì‹œê°„ ê³µë¶€í–ˆì„ ê²½ìš° 102ì ìœ¼ë¡œ ì˜ˆì¸¡


datasets::iris3

iris3

datasets::iris



#ë¡œì§€ìŠ¤í‹± íšŒê·€

?glm()

datasets::iris

#ë‚´ìž¥ ë°ì´í„°(datasets) ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜
?data
data(iris)


iris[ , ]


remove(list = ls())

#Rì˜ ìžë£Œêµ¬ì¡°
#l
#a
#m
#v
#s   f


#yê°’ì„ ë‘ê°€ì§€ë¡œ í•˜ê¸° ìœ„í•´
# ì¢…ì„ setosaëƒ versicolor

#ì¼ë¶€ë¶„ ì¶”ì¶œí•˜ëŠ” í•¨ìˆ˜
?subset()

iris$Species

y<-subset(iris, Species=='setosa' | Species=='versicolor')

y$Species

#ë²”ì£¼í˜• ë°ì´í„°ë¡œ ë§Œë“œëŠ” í•¨ìˆ˜
?factor()

?glm()

#formula ì‹  ì¢…ì†ë³€ìˆ˜  ~ ë…ë¦½ë³€ìˆ˜ 

colnames(iris)


#ë°ì´í„° êµ¬ì¡° í™•ì¸í•˜ëŠ” í•¨ìˆ˜
str

str(iris)

#ë°ì´í„° íƒ€ìž… í™•ì¸í•˜ëŠ” í•¨ìˆ˜

?class

?is

class(iris$Species)

is(iris$Species)

# ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ ë§Œë“¤ê¸°ê¸°            

loglm <- glm(Species ~ Sepal.Length  , data = iris, family = 'binomial')


loglm

#
?summary()


summary(loglm)


exp(5.176)



#plot(y$Sepal.Length, y$Species, xlab = "Sepal.Length")

#x<-seq(min(y$Sepal.Length), max(y$Sepal.Length), 0.1)

#lines(x, 1 + (1/(1+(1/exp(-27.829  + 5.176 *x)))), type = 'l', col='red')

plot(y$Sepal.Length, y$Species, xlab = "Sepal.Length")

x<-seq(min(y$Sepal.Length), max(y$Sepal.Length), 0.1)


x

lines(x, 1 + (1/(1+(1/exp(-27.829  + 5.176 *x)))), type = 'l', col='green')


lines(x, 1 + (1/(1+exp(27.829  - 5.176 *x))), type = 'l', col='blue')

#íšŒê·€ ë¶„ì„


adv<-c(13,8,	10,	15,	12,	15,	14,	15,	17,	19,	20,	21,	22,	21,	25)
sales<-c(94,	70,	90,	100,	95,	100,	85,	95,	105,	105,	110,	105,	104,	105,	121)

?plot

plot(adv, sales)

lm(sales ~ adv)

lin_model<-lm(sales ~ adv)

summary(lin_model)


plot(lin_model)


cor(adv, sales)

cor(adv, sales)^2

#R-squared:  0.7884,

#ì¶”ì •ëœ íšŒê·€ì‹ì´ ì–´ëŠ ì •ë„ ì¸¡ì •ì¹˜ë“¤ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ì˜ ì •ë„

#ì„¤ëª…ë ¥ì€ 0~1ê¹Œì§€ì˜ ìˆ«ìžë¡œ ë‚˜íƒ€ë‚´ê±°ë‚˜ 
#ëª‡ %ì˜ ì„¤ëª…ë ¥ì„ ê°€ì§€ëŠ”ì§€ í™•ë¥ ë¡œ í‘œí˜„
#ð‘…^2 ì˜ ê°’ì€ 1ì— ê·¼ì ‘í• ìˆ˜ë¡
#íšŒê·€ì„ ì´ ì¸¡ì •ì¹˜ë¥¼ ìž˜ ë°˜ì˜í•˜ê³  ìžˆë‹¤ê³  í•  ìˆ˜ ìžˆë‹¤. 



#y= 2.186*x + 62.929

#ë°ì´í„°ì˜ ì–‘ì´ ë§Žì§€ ì•Šì€ ìƒí™©ì—ì„œ í†µê³„ì  ë°ì´í„° ë¶„ì„ ë°©ë²•ì„ ì‚¬ìš©í•˜ê³  ìˆ˜ì¹˜ë¥¼ ì˜ˆì¸¡í•˜ê³ ìž í•˜ëŠ” ë¬¸ì œì˜ ê²½ìš° 
#íšŒê·€ë¶„ì„ì‹œ ì²´í¬í•´ì•¼ í•  ì‚¬í•­
# ì„ í˜•ì„± : ë…ë¦½ë³€ìˆ˜(ê´‘ê³ ì•¡)ì˜ ë³€í™”ì— ë”°ë¼ ì¢…ì†ë³€ìˆ˜(ë§¤ì¶œì•¡)ë„ ì¼ì • í¬ê¸°ë¡œ ë³€í™”
# ë…ë¦½ì„± : ìž”ì°¨(ì˜¤ì°¨)ëŠ” ë…ë¦½ë³€ìˆ˜ì˜ ê°’ê³¼ ê´€ë ¨ì´ ì—†ì–´ì•¼ í•¨
# ë“±ë¶„ì‚°ì„± : ë…ë¦½ë³€ìˆ˜ì˜ ëª¨ë“  ê°’ì— ëŒ€í•´ ì˜¤ì°¨ë“¤ì˜ ë¶„ì‚°ì´ ì¼ì •
# ë¹„ìƒê´€ì„± : ê´€ì¸¡ì¹˜ë“¤ì˜ ìž”ì°¨ë“¤ë¼ë¦¬ ìƒê¶Œì´ ì—†ì–´ì•¼ í•¨
# ì •ìƒì„± : ìž”ì°¨í•­ì´ ì •ê·œë¶„í¬ë¥¼ ì´ë£¨ì–´ì•¼ í•¨


#ë‹¤ì¤‘íšŒê·€, ë‹¤í•­íšŒê·€ 
#ìµœì  íšŒê·€ ë°©ì •ì‹ì˜ ì„ íƒ : ì„¤ëª… ë³€ìˆ˜ì˜ ì„ íƒ
#1) ëª¨ë“  ê°€ëŠ¥í•œ ì¡°í•©ì˜ íšŒê·€ ë¶„ì„
#2) ë‹¨ê³„ì  ë³€ìˆ˜ ì„ íƒ ( ì „ì§„ ì„ íƒë²•(forward selection), í›„ì§„ ì œê±°ë²•(backward), ë‹¨ê³„ë³„ ë°©ë²•(stepwise)))

scores<-c(42,	69,	56,	41,	57,	48,	65,	49,	65,	58)

?quantile()

quantile(scores, 0.25)
quantile(scores, 0.75)

63.25 - 48.25


IQR(scores)
#ì‚¬ë¶„ìœ„ìˆ˜ êµ¬í•  ë•Œ python, Rì€ quantile
#ì—‘ì…€ê³¼ ë§žì¶”ê³ ìž í•  ê²½ìš° type=6


IQR(scores, type = 6)

rm(list=ls())

df<-read.csv(file.choose())




rm(list=ls())

X1<-c(7,1,11,11,7,11,3,1,2,21,1,11,10)
X2<-c(26,29,56,31,52,55,71,31,54,47,40,66,68)
X3<-c(6,15,8,8,6,9,17,22,18,4,23,9,8)
X4<-c(60,52,20,47,33,22,6,44,22,26,34,12,12)
Y<-c(78.5,74.3,104.3,87.6,95.9,109.2,102.7,72.5,93.1,115.9,83.8,113.3,109.4)
df<-data.frame(X1,X2,X3,X4,Y)
df


str(df)


#íšŒê·€ ë¶„ì„
#10ë¶„
#íšŒê·€ì‹ ì œì¶œ

?lm


lm(Y ~ ., data = df)
# lm(Y ~ X1 + X2 + X3 + X4, data = df)

#ë‹¤ì¤‘íšŒê·€
lm(Y ~ X1 + X2 + X3 + X4, data = df)

# ì²« ë²ˆì§¸ íšŒê·€ì‹ 
# y = 1.5511 * x1 + 0.5102 * x2 + 0.1019 * x3 -0.1441 *x4   +  62.4054


summary(lm(Y ~ ., data = df))


lm(Y ~ X1 + X2 +  X4, data = df)
summary(lm(Y ~ X1 + X2 +  X4, data = df))

# ë‘ ë²ˆì§¸ íšŒê·€ì‹ 
# y = 1.4519  * x1 + 0.4161 * x2 -0.2365 * x4   + 71.6483 




lm(Y ~ X1 + X2 , data = df)
summary(lm(Y ~ X1 + X2 , data = df))

#ìµœì¢… íšŒê·€ì‹ 
# y = 1.4683  * x1 + 0.6623 * x2  + 52.5773 

#ìœ„ê°€ ë°”ë¡œ í›„ì§„ ì œê±°ë²•ì„ ìˆ˜ë™ìœ¼ë¡œ ë³€ìˆ˜ ì œê±°ë¥¼ ì§„í–‰í•¨
#ì´ëŸ° ë°©ë²•ì€ ë³€ìˆ˜ì˜ ìˆ˜ê°€ ë§Žì„ ë•ŒëŠ” ë²ˆê±°ë¡œìš¸ ìˆ˜ ìžˆë‹¤. 

#ë‹¨ê³„ë³„ ë³€ìˆ˜ ì„ íƒì˜ ë°©ë²•ì„ ìžë™ìœ¼ë¡œ ìˆ˜í–‰í•´ì£¼ëŠ” ëª…ë ¤ì–´ëŠ”ì•„ëž˜ì™€ ê°™ìŒ
#step(lm(ì¢…ì†ë³€ìˆ˜ ~ ì„¤ëª…ë³€ìˆ˜ , ë°ì´í„°ì„¸íŠ¸), scope=list(lower= ~ 1, upper= ~ ì„¤ëª…ë³€ìˆ˜ ), direction="ë³€ìˆ˜ ì„ íƒ ë°©ë²•")
?step
#ë³€ìˆ˜ ì„ íƒ ë°©ë²• "both", "backward", "forward"


#ì „ì§„ ì„ íƒë²•


step(lm(Y ~ 1, df), scope=list(lower= ~ 1, upper= ~ X1 + X2 + X3 + X4 ), direction = "forward")
# ì „ì§„ ì„ íƒë²•ì„ í†µí•œ ìµœì¢… íšŒê·€ì‹
# y = 1.4519  * x1 + 0.4161 * x2  - 0.2365 * x4 + 71.6483 

#AIC

#Akaike ì •ë³´ ê¸°ì¤€ ( AIC )ì€ ì˜ˆì¸¡ ì˜¤ë¥˜ ì˜ ì¶”ì •ê¸° ì´ë¯€ë¡œ ì£¼ì–´ì§„ ë°ì´í„° ì„¸íŠ¸ì— ëŒ€í•œ í†µê³„ ëª¨ë¸ ì˜ ìƒëŒ€ì  í’ˆì§ˆ ìž…ë‹ˆë‹¤. [1] [2] [3] ë°ì´í„°ì— ëŒ€í•œ ëª¨ë¸ ëª¨ìŒì´ ì£¼ì–´ì§€ë©´ AICëŠ” ë‹¤ë¥¸ ê° ëª¨ë¸ê³¼ ë¹„êµí•˜ì—¬ ê° ëª¨ë¸ì˜ í’ˆì§ˆì„ ì¶”ì •í•©ë‹ˆë‹¤. ë”°ë¼ì„œ AICëŠ” ëª¨ë¸ ì„ íƒ ìˆ˜ë‹¨ì„ ì œê³µí•©ë‹ˆë‹¤ .

#AICëŠ” ì •ë³´ ì´ë¡ ì„ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤ . ë°ì´í„°ë¥¼ ìƒì„±í•œ í”„ë¡œì„¸ìŠ¤ë¥¼ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ í†µê³„ ëª¨ë¸ì„ ì‚¬ìš©í•  ë•Œ ê·¸ í‘œí˜„ì€ ê±°ì˜ ì •í™•í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í”„ë¡œì„¸ìŠ¤ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ëª¨ë¸ì„ ì‚¬ìš©í•˜ë©´ ì¼ë¶€ ì •ë³´ê°€ ì†ì‹¤ë©ë‹ˆë‹¤. AICëŠ” ì£¼ì–´ì§„ ëª¨ë¸ì— ì˜í•´ ì†ì‹¤ëœ ì •ë³´ì˜ ìƒëŒ€ì ì¸ ì–‘ì„ ì¶”ì •í•©ë‹ˆë‹¤. ëª¨ë¸ì´ ì†ì‹¤í•˜ëŠ” ì •ë³´ê°€ ì ì„ìˆ˜ë¡ í•´ë‹¹ ëª¨ë¸ì˜ í’ˆì§ˆì´ ë†’ì•„ì§‘ë‹ˆë‹¤

#ë‹¨ê³„ì  ë°©ë²•ì„ ì ìš©í•˜ì—¬ ëª¨í˜•ì„ ì„ íƒí•˜ì‹œì˜¤

step(lm(Y ~ 1, df), scope=list(lower= ~ 1, upper= ~ X1 + X2 + X3 + X4 ), direction = "both")


#MASS íŒ¨í‚¤ì§€ì˜ hills ë°ì´í„°ë¥¼ ì´ìš©í•˜ì—¬, step í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì „ì§„ ì„ íƒë²•ì„ ì ìš©í•˜ì‹œì˜¤..
#íšŒê·€ì‹ì€?
#ì´ ë•Œ timeì´ ì¢…ì† ë³€ìˆ˜

library(MASS)
MASS::hills
hills

str(hills)


step(lm(time  ~ 1, hills), scope=list(lower= ~ 1, upper= ~ dist + climb ), direction = "forward")


time = 6.21796 * dist +   0.01105 * climb     -8.99204 








